"use strict";(globalThis.webpackChunkmy_docusaurus_project=globalThis.webpackChunkmy_docusaurus_project||[]).push([[5515],{6899:(n,e,a)=>{a.r(e),a.d(e,{assets:()=>h,contentTitle:()=>c,default:()=>p,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"module-4/llm-cognitive-planning","title":"4.3 Cognitive Planning: From Chat to JSON","description":"How Robots \\"Think\\"","source":"@site/docs/module-4/03-llm-cognitive-planning.mdx","sourceDirName":"module-4","slug":"/module-4/llm-cognitive-planning","permalink":"/phys-ai-book/docs/module-4/llm-cognitive-planning","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"4.2 Voice-to-Action: OpenAI Whisper","permalink":"/phys-ai-book/docs/module-4/whisper-voice-integration"},"next":{"title":"4.4 Structuring Thought: LangChain for Robotics","permalink":"/phys-ai-book/docs/module-4/langchain-for-robotics"}}');var i=a(4848),t=a(8453),o=a(3715),r=a(4021);const l={},c="4.3 Cognitive Planning: From Chat to JSON",h={},d=[{value:"How Robots &quot;Think&quot;",id:"how-robots-think",level:2},{value:"Prompt Engineering for Robots",id:"prompt-engineering-for-robots",level:3},{value:"Constrained Decoding &amp; Grounding",id:"constrained-decoding--grounding",level:2},{value:"Code Example: Function Calling (Tools)",id:"code-example-function-calling-tools",level:3},{value:"Sochne Ki Salahiyat: Chat se JSON tak",id:"sochne-ki-salahiyat-chat-se-json-tak",level:2},{value:"Prompt Engineering",id:"prompt-engineering",level:3},{value:"Constrained Decoding aur Grounding",id:"constrained-decoding-aur-grounding",level:2}];function m(n){const e={annotation:"annotation",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",math:"math",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",ol:"ol",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",ul:"ul",...(0,t.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"43-cognitive-planning-from-chat-to-json",children:"4.3 Cognitive Planning: From Chat to JSON"})}),"\n",(0,i.jsxs)(o.A,{level:"novice",language:"english",children:[(0,i.jsx)(e.h2,{id:"how-robots-think",children:'How Robots "Think"'}),(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"The Translator"}),'\nWhen you say "Clean the room," you know what that means.']}),(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"Find trash."}),"\n",(0,i.jsx)(e.li,{children:"Pick up trash."}),"\n",(0,i.jsxs)(e.li,{children:["Put in bin.\nA robot only understands specific code commands like ",(0,i.jsx)(e.code,{children:"move_to(x, y)"})," or ",(0,i.jsx)(e.code,{children:"grip(open)"}),"."]}),"\n"]}),(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"LLM as a Planner"}),'\nWe use an LLM (like GPT-4 or Llama-3) as a translator. We give it a "System Prompt" that explains the robot\'s capabilities.']}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Input"}),': "I spilled my drink."']}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"LLM Thinking"}),': "Spilled drink means liquid on floor. I need to mop it."']}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Output"}),": ",(0,i.jsx)(e.code,{children:"[find_mop(), go_to_spill(), use_mop()]"}),"."]}),"\n"]}),(0,i.jsx)(e.h3,{id:"prompt-engineering-for-robots",children:"Prompt Engineering for Robots"}),(0,i.jsxs)(e.p,{children:["We cannot just chat with the robot. We need ",(0,i.jsx)(e.strong,{children:"Structured Output"}),".\nWe tell the LLM: ",(0,i.jsx)(e.em,{children:'"You are a robot helper. Only reply with a JSON list of actions."'})]}),(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"Python Example (using OpenAI)"})}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'import openai\nimport json\n\nclient = openai.OpenAI(api_key="sk-...")\n\ndef get_robot_plan(user_command):\n    system_prompt = """\n    You are a robot with these functions:\n    - navigate(location_name)\n    - pick_up(object_name)\n    - place(object_name, location_name)\n    \n    Output format: JSON list of dictionaries.\n    Example: [{"action": "navigate", "target": "kitchen"}]\n    """\n    \n    response = client.chat.completions.create(\n        model="gpt-3.5-turbo",\n        messages=[\n            {"role": "system", "content": system_prompt},\n            {"role": "user", "content": user_command}\n        ],\n        response_format={ "type": "json_object" }\n    )\n    \n    return json.loads(response.choices[0].message.content)\n\n# Test\nplan = get_robot_plan("Bring me the apple from the kitchen.")\nprint(plan)\n# Output: \n# {\n#   "plan": [\n#     {"action": "navigate", "target": "kitchen"},\n#     {"action": "pick_up", "target": "apple"},\n#     {"action": "navigate", "target": "user"},\n#     {"action": "place", "target": "user", "location": "hand"}\n#   ]\n# }\n'})}),(0,i.jsx)(e.p,{children:"Now, your Python code can read this JSON and call the actual ROS functions."})]}),"\n",(0,i.jsxs)(o.A,{level:"expert",language:"english",children:[(0,i.jsx)(e.h2,{id:"constrained-decoding--grounding",children:"Constrained Decoding & Grounding"}),(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"The Hallucination Problem"}),'\nLLMs love to hallucinate. If you ask a robot to "Make me a sandwich," the LLM might output ',(0,i.jsx)(e.code,{children:"spread_peanut_butter()"}),".\nBut if your robot ",(0,i.jsx)(e.strong,{children:"does not have"})," a ",(0,i.jsx)(e.code,{children:"spread_peanut_butter"})," function defined in C++, the system will crash."]}),(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Solution 1: Constrained Decoding (Grammars)"}),"\nWhen running local LLMs (like Llama-3 on Jetson using ",(0,i.jsx)(e.code,{children:"llama.cpp"})," or ",(0,i.jsx)(e.code,{children:"vLLM"}),"), we use ",(0,i.jsx)(e.strong,{children:"Grammar Constraints (BNF)"}),".\nThis forces the LLM to strictly follow a syntax. It ",(0,i.jsx)(e.em,{children:"cannot"})," generate a token that violates the grammar."]}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.em,{children:"Result"}),": 100% syntactically correct JSON."]}),"\n"]}),(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Solution 2: Grounding (Symbol Grounding Problem)"}),'\nThe LLM knows "Apple". The Robot knows ',(0,i.jsx)(e.code,{children:"object_id: 402"}),".\nWe need a ",(0,i.jsx)(e.strong,{children:"Grounding Module"}),"."]}),(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["LLM outputs: ",(0,i.jsx)(e.code,{children:'pick_up("apple")'}),"."]}),"\n",(0,i.jsxs)(e.li,{children:["Vision System (YOLO/DINO) scans the table.","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["Detected: ",(0,i.jsx)(e.code,{children:"apple"})," (confidence 0.9) at ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mn,{children:"0.5"}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsx)(e.mi,{children:"y"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mn,{children:"0.2"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"(x=0.5, y=0.2)"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8389em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(e.span,{className:"mord",children:"0.5"}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord",children:"0.2"}),(0,i.jsx)(e.span,{className:"mclose",children:")"})]})]})]}),"."]}),"\n",(0,i.jsxs)(e.li,{children:["Detected: ",(0,i.jsx)(e.code,{children:"red_ball"})," (confidence 0.4)."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Matcher"}),': Matches string "apple" to detection ',(0,i.jsx)(e.code,{children:"apple"}),"."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Execution"}),": Calls ",(0,i.jsx)(e.code,{children:"pick_up(0.5, 0.2)"}),"."]}),"\n"]}),(0,i.jsx)(e.h3,{id:"code-example-function-calling-tools",children:"Code Example: Function Calling (Tools)"}),(0,i.jsx)(e.p,{children:'Modern LLM APIs support "Tools" natively.'}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'tools = [{\n    "type": "function",\n    "function": {\n        "name": "navigate",\n        "parameters": {\n            "type": "object",\n            "properties": {\n                "destination": {"type": "string", "enum": ["kitchen", "bedroom", "lab"]}\n            }\n        }\n    }\n}]\n'})}),(0,i.jsxs)(e.p,{children:["Defining ",(0,i.jsx)(e.code,{children:"enum"}),' restricts the LLM to only known locations on the semantic map. If the user says "Go to Mars", the LLM will likely fail gracefully or ask for clarification, rather than outputting ',(0,i.jsx)(e.code,{children:'navigate("Mars")'})," which would confuse the Nav2 stack."]})]}),"\n",(0,i.jsxs)(o.A,{level:"novice",language:"urdu",children:[(0,i.jsx)(e.h2,{id:"sochne-ki-salahiyat-chat-se-json-tak",children:"Sochne Ki Salahiyat: Chat se JSON tak"}),(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"Robot Kaise Sochta Hai?"})}),(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Tarjuman (Translator)"}),'\nJab aap kehte hain "Kamra saaf karo", aap ko pata hai is ka matlab kya hai. (Kachra uthao, bin mein dalo).\nRobot ko sirf code samajh aata hai jaise ',(0,i.jsx)(e.code,{children:"chalo(x, y)"})," ya ",(0,i.jsx)(e.code,{children:"pakro(open)"}),"."]}),(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"LLM Planner"}),"\nHum LLM (jaise GPT) ko bataur Tarjuman use karte hain."]}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Input"}),': "Meri drink gir gayi hai."']}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"LLM Ki Soch"}),': "Drink girne ka matlab hai farsh geela hai. Mujhe pocha lagana hai."']}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Output"}),": ",(0,i.jsx)(e.code,{children:"[pocha_dhoondo(), wahan_jao(), pocha_lagao()]"}),"."]}),"\n"]}),(0,i.jsx)(e.h3,{id:"prompt-engineering",children:"Prompt Engineering"}),(0,i.jsxs)(e.p,{children:["Hum robot se gup shup nahi kar sakte. Humein ",(0,i.jsx)(e.strong,{children:"Structured Output"})," chahiye.\nHum LLM ko sakhti se kehte hain: ",(0,i.jsx)(e.em,{children:'"Tum robot ho. Sirf JSON list mein jawab dena."'})]}),(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Python Misal"}),'\nHum OpenAI ko batate hain ke robot ke paas kaun kaun se functions hain (Chalna, Uthana, Rakhna).\nJab user kehta hai "Kitchen se seb laao", to LLM usay tod kar JSON bana deta hai:']}),(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:'navigate("kitchen")'})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:'pick_up("apple")'})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:'navigate("user")'})}),"\n"]}),(0,i.jsx)(e.p,{children:"Ab aap ka Python code is JSON ko parh kar robot ko asli hukm bhej sakta hai."})]}),"\n",(0,i.jsxs)(o.A,{level:"expert",language:"urdu",children:[(0,i.jsx)(e.h2,{id:"constrained-decoding-aur-grounding",children:"Constrained Decoding aur Grounding"}),(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Hallucination (Ghalat Fehmi) Ka Masla"}),'\nLLMs aksar aisi baat kar dete hain jo sach nahi hoti.\nAgar aap robot ko kahein "Sandwich banao", to LLM keh dega ',(0,i.jsx)(e.code,{children:"makkhan_lagao()"}),".\nLekin agar aap ke robot ke paas ",(0,i.jsx)(e.code,{children:"makkhan_lagao"})," ka function code mein hai hi nahi, to robot crash ho jaye ga."]}),(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Hal 1: Constrained Decoding"}),"\nJab hum Jetson par Llama-3 chalate hain, hum ",(0,i.jsx)(e.strong,{children:"Grammar"})," lagate hain.\nIs se computer majboor ho jata hai ke wo sirf wahi lafz bole jo humare functions list mein hain. Wo apni marzi se naya function ijad nahi kar sakta."]}),(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Hal 2: Grounding (Haqeeqat se Jorna)"}),'\nLLM ko pata hai "Seb" (Apple) kya hai. Lekin Robot ko sirf ',(0,i.jsx)(e.code,{children:"object_id: 402"})," pata hai.\nHumein ",(0,i.jsx)(e.strong,{children:"Grounding"})," karni parti hai."]}),(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:'LLM kehta hai: "Seb Uthao".'}),"\n",(0,i.jsxs)(e.li,{children:["Camera (YOLO) dhoondta hai. Usay seb milta hai coordinates ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mn,{children:"0.5"}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsx)(e.mn,{children:"0.2"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"(0.5, 0.2)"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord",children:"0.5"}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mord",children:"0.2"}),(0,i.jsx)(e.span,{className:"mclose",children:")"})]})})]})," par."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Matcher"}),': Lafz "Seb" ko coordinates se jorta hai.']}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Execution"}),": Robot wahan jata hai."]}),"\n"]}),(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Tools (Function Calling)"}),"\nHum LLM ko ",(0,i.jsx)(e.code,{children:"enum"})," (List) dete hain.\n",(0,i.jsx)(e.em,{children:'"Sirf in jaghon par ja sakte ho: [Kitchen, Bedroom]"'}),'.\nAgar user kahe "Mars par jao", to LLM ghalat command nahi banaye ga kyunke Mars list mein nahi hai.']})]}),"\n",(0,i.jsx)(r.A,{questions:[{question:"Why can't we simply pipe the output of ChatGPT directly to the robot's motors?",options:["ChatGPT is too smart","ChatGPT outputs unstructured natural language, but robots need structured commands (JSON/Code)","Robots only understand Spanish","It works perfectly fine"],correctAnswer:1},{question:"What is 'Grounding' in the context of VLA?",options:["Putting the robot on the floor","Connecting the electrical ground wire","Linking abstract concepts (like the word 'Apple') to specific physical world data (like coordinates of the apple)","Punishing the robot"],correctAnswer:2},{question:"Urdu: Agar LLM koi aisa function bata de jo robot kar hi nahi sakta (Hallucination), to hum isay kaise rokte hain?",options:["Robot ko band kar ke","Grammar Constraints aur Function Definitions ke zariye","Internet tez kar ke","Robot ko daant kar"],correctAnswer:1}]})]})}function p(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(m,{...n})}):m(n)}}}]);