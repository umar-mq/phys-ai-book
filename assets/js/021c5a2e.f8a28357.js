"use strict";(globalThis.webpackChunkmy_docusaurus_project=globalThis.webpackChunkmy_docusaurus_project||[]).push([[9604],{6053:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>c,contentTitle:()=>h,default:()=>j,frontMatter:()=>t,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"module-3/nav2-navigation-stack","title":"3.4 Planning the Path: The Nav2 Stack","description":"Moving from A to B","source":"@site/docs/module-3/04-nav2-navigation-stack.mdx","sourceDirName":"module-3","slug":"/module-3/nav2-navigation-stack","permalink":"/phys-ai-book/docs/module-3/nav2-navigation-stack","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"3.3 The Sense of Direction: Visual SLAM","permalink":"/phys-ai-book/docs/module-3/isaac-ros-vslam"},"next":{"title":"3.5 Infinite Data: Synthetic Data Generation (SDG)","permalink":"/phys-ai-book/docs/module-3/synthetic-data-generation"}}');var i=n(4848),r=n(8453),l=n(3715),o=n(4021);const t={},h="3.4 Planning the Path: The Nav2 Stack",c={},d=[{value:"Moving from A to B",id:"moving-from-a-to-b",level:2},{value:"Installing Nav2",id:"installing-nav2",level:3},{value:"Running Nav2 with Isaac Sim",id:"running-nav2-with-isaac-sim",level:3},{value:"Behavior Trees &amp; Controller Tuning",id:"behavior-trees--controller-tuning",level:2},{value:"Controller Server (Local Planner)",id:"controller-server-local-planner",level:3},{value:"Integration Workflow",id:"integration-workflow",level:3},{value:"Rasta Plan Karna: Nav2",id:"rasta-plan-karna-nav2",level:2},{value:"Nav2 Chalana",id:"nav2-chalana",level:3},{value:"Behavior Trees aur MPPI",id:"behavior-trees-aur-mppi",level:2},{value:"Controller (Local Planner)",id:"controller-local-planner",level:3}];function g(e){const a={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.header,{children:(0,i.jsx)(a.h1,{id:"34-planning-the-path-the-nav2-stack",children:"3.4 Planning the Path: The Nav2 Stack"})}),"\n",(0,i.jsxs)(l.A,{level:"novice",language:"english",children:[(0,i.jsx)(a.h2,{id:"moving-from-a-to-b",children:"Moving from A to B"}),(0,i.jsx)(a.p,{children:(0,i.jsx)(a.strong,{children:"The Brain of Navigation"})}),(0,i.jsxs)(a.p,{children:["We know ",(0,i.jsx)(a.em,{children:"where"})," we are (VSLAM). Now we need to go somewhere.\n",(0,i.jsx)(a.strong,{children:"Nav2"})," is the standard ROS 2 library for moving mobile robots.\nIt answers two questions:"]}),(0,i.jsxs)(a.ol,{children:["\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Global Planner"}),': "How do I get from the Kitchen to the Bedroom?" (Like Google Maps).']}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Local Planner"}),': "There is a shoe on the floor, how do I go around it right now?" (Reflexes).']}),"\n"]}),(0,i.jsxs)(a.p,{children:[(0,i.jsx)(a.strong,{children:"Costmaps"}),"\nThe robot sees the world as a grid called a ",(0,i.jsx)(a.strong,{children:"Costmap"}),"."]}),(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Black cells"}),": Walls (Fatal)."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Grey cells"}),": Near walls (Dangerous)."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"White cells"}),": Free space (Safe).\nThe robot tries to stay in the white cells."]}),"\n"]}),(0,i.jsx)(a.h3,{id:"installing-nav2",children:"Installing Nav2"}),(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"sudo apt install ros-humble-navigation2 ros-humble-nav2-bringup\n"})}),(0,i.jsx)(a.h3,{id:"running-nav2-with-isaac-sim",children:"Running Nav2 with Isaac Sim"}),(0,i.jsxs)(a.p,{children:["Assuming you have your robot in Isaac Sim publishing ",(0,i.jsx)(a.code,{children:"/scan"})," (Lidar) and ",(0,i.jsx)(a.code,{children:"/tf"}),"."]}),(0,i.jsxs)(a.ol,{children:["\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Launch Nav2"}),":","\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"ros2 launch nav2_bringup navigation_launch.py use_sim_time:=True\n"})}),"\n"]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Open Rviz"}),":\nYou will see the robot and the map."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Set Initial Pose"}),': Click "2D Pose Estimate" button on top. Click where the robot is.']}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Send Command"}),': Click "Nav2 Goal" button. Click where you want it to go.']}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Watch"}),": The robot will plan a path (Green line) and drive there, avoiding obstacles in Isaac Sim."]}),"\n"]})]}),"\n",(0,i.jsxs)(l.A,{level:"expert",language:"english",children:[(0,i.jsx)(a.h2,{id:"behavior-trees--controller-tuning",children:"Behavior Trees & Controller Tuning"}),(0,i.jsx)(a.p,{children:(0,i.jsx)(a.strong,{children:"The Nav2 Architecture"})}),(0,i.jsxs)(a.p,{children:["Nav2 is not a single node; it is a modular stack orchestrated by a ",(0,i.jsx)(a.strong,{children:"Behavior Tree (BT)"}),'.\nInstead of a simple "If-Then" loop, BTs allow complex logic:']}),(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.em,{children:"Sequence"}),": Plan Path -> Follow Path."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.em,{children:"Recovery"}),": If stuck -> Spin -> Back up -> Wait -> Retry."]}),"\n"]}),(0,i.jsxs)(a.p,{children:[(0,i.jsx)(a.strong,{children:"The XML Behavior Tree"}),":\nYou can customize the robot's logic by editing the ",(0,i.jsx)(a.code,{children:"navigate_to_pose_w_replanning_and_recovery.xml"}),' file. For a humanoid, you might add a "Crouch" action if the ceiling is low.']}),(0,i.jsx)(a.h3,{id:"controller-server-local-planner",children:"Controller Server (Local Planner)"}),(0,i.jsxs)(a.p,{children:["This follows the global path while avoiding dynamic obstacles.\nFor differential drive robots, we use ",(0,i.jsx)(a.strong,{children:"DWB (Dynamic Window Approach)"}),".\nFor Humanoids/Ackermann vehicles, we prefer ",(0,i.jsx)(a.strong,{children:"MPPI (Model Predictive Path Integral)"}),"."]}),(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"MPPI"}),": It simulates thousands of random trajectories into the future (using GPU), checks which ones hit obstacles, and chooses the best average path. It is smoother and handles dynamic actors (people walking) better than DWB."]}),"\n"]}),(0,i.jsxs)(a.p,{children:[(0,i.jsx)(a.strong,{children:"Tuning Costmaps for Isaac Sim"}),"\nIsaac Sim Lidar is perfect. Real Lidar is noisy."]}),(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Inflation Layer"}),": Expands the walls by the radius of the robot.","\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.em,{children:"Tip"}),": For a humanoid with swinging arms, increase the inflation radius to ensure the arms don't hit door frames."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Voxel Layer"}),': If using 3D depth cameras, use the Voxel Layer to detect obstacles hanging in the air (like tables) that a 2D Lidar sees as "legs only".']}),"\n"]}),(0,i.jsx)(a.h3,{id:"integration-workflow",children:"Integration Workflow"}),(0,i.jsxs)(a.ol,{children:["\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Isaac Sim"}),": Publishes ",(0,i.jsx)(a.code,{children:"/scan"}),", ",(0,i.jsx)(a.code,{children:"/odom"}),", ",(0,i.jsx)(a.code,{children:"/tf"}),"."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"VSLAM"}),": Publishes ",(0,i.jsx)(a.code,{children:"map -> odom"}),"."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Nav2"}),": Subscribes to map and scan. Publishes ",(0,i.jsx)(a.code,{children:"/cmd_vel"}),"."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Isaac Sim"}),": Subscribes to ",(0,i.jsx)(a.code,{children:"/cmd_vel"})," and applies wheel velocities."]}),"\n"]})]}),"\n",(0,i.jsxs)(l.A,{level:"novice",language:"urdu",children:[(0,i.jsx)(a.h2,{id:"rasta-plan-karna-nav2",children:"Rasta Plan Karna: Nav2"}),(0,i.jsx)(a.p,{children:(0,i.jsx)(a.strong,{children:"Navigation Ka Dimagh"})}),(0,i.jsxs)(a.p,{children:["Humein pata hai hum kahan hain (VSLAM). Ab humein kahin jana hai.\n",(0,i.jsx)(a.strong,{children:"Nav2"})," ROS 2 ka standard system hai robots ko chalane ke liye.\nYeh do sawalon ka jawab deta hai:"]}),(0,i.jsxs)(a.ol,{children:["\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Global Planner"}),': "Kitchen se Bedroom kaise jaun?" (Jaise Google Maps).']}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Local Planner"}),': "Raaste mein joota para hai, us se kaise bachoon?" (Reflexes).']}),"\n"]}),(0,i.jsxs)(a.p,{children:[(0,i.jsx)(a.strong,{children:"Costmaps (Khatray Ka Naqsha)"}),"\nRobot dunya ko ek grid ki tarah dekhta hai."]}),(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Kaalay Dabbay"}),": Deewarein (Maut)."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Grey Dabbay"}),": Deewar ke qareeb (Khatra)."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Safed Dabbay"}),": Khali jagah (Mehfooz).\nRobot koshish karta hai ke safed hisson mein rahay."]}),"\n"]}),(0,i.jsx)(a.h3,{id:"nav2-chalana",children:"Nav2 Chalana"}),(0,i.jsxs)(a.p,{children:["Agar Isaac Sim mein robot ",(0,i.jsx)(a.code,{children:"/scan"})," (Lidar) bhej raha hai."]}),(0,i.jsxs)(a.ol,{children:["\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Launch"}),":","\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"ros2 launch nav2_bringup navigation_launch.py use_sim_time:=True\n"})}),"\n"]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Rviz"}),": Kholein."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Initial Pose"}),': Upar "2D Pose Estimate" button dabayein aur batayein robot kahan khara hai.']}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Goal"}),': "Nav2 Goal" button dabayein aur click karein kahan jana hai.']}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Dekhein"}),": Robot rasta (Green line) banaye ga aur chal pare ga."]}),"\n"]})]}),"\n",(0,i.jsxs)(l.A,{level:"expert",language:"urdu",children:[(0,i.jsx)(a.h2,{id:"behavior-trees-aur-mppi",children:"Behavior Trees aur MPPI"}),(0,i.jsx)(a.p,{children:(0,i.jsx)(a.strong,{children:"Nav2 Kaise Kaam Karta Hai?"})}),(0,i.jsxs)(a.p,{children:["Nav2 koi aik program nahi hai. Yeh ",(0,i.jsx)(a.strong,{children:"Behavior Tree (BT)"})," ke zariye control hota hai.\nBT faisla karta hai:"]}),(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsx)(a.li,{children:"Pehle Rasta banao."}),"\n",(0,i.jsx)(a.li,{children:"Phir raste par chalo."}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.em,{children:"Recovery"}),": Agar phans jao, to peechay hato, ghoomo, aur dobara koshish karo."]}),"\n"]}),(0,i.jsx)(a.h3,{id:"controller-local-planner",children:"Controller (Local Planner)"}),(0,i.jsxs)(a.p,{children:["Yeh wo hissa hai jo robot ko chalata hai.\nHumanoid robots ke liye hum ",(0,i.jsx)(a.strong,{children:"MPPI"})," controller pasand karte hain."]}),(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"MPPI"}),': Yeh GPU ka istemal kar ke aanay wale waqt ki hazaron possibilities sochta hai. "Agar main dayein gaya to kya hoga? Agar baayein gaya to kya hoga?". Phir ye sab se mehfooz rasta chunta hai. Yeh DWB (puranay tareeqay) se bohat behtar hai.']}),"\n"]}),(0,i.jsx)(a.p,{children:(0,i.jsx)(a.strong,{children:"Costmaps Tuning"})}),(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Inflation"}),": Deewaron ko naqshay mein thora mota dikhaya jata hai taake robot bilkul sath ragarr kar na guzray."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Voxel Layer"}),": Agar aap ke paas Depth Camera hai, to Voxel layer use karein. Yeh hawa mein latakti cheezon (jaise table ka oopar wala hissa) ko bhi dekh leta hai."]}),"\n"]})]}),"\n",(0,i.jsx)(o.A,{questions:[{question:"Which component of Nav2 calculates the long-distance path from start to goal?",options:["Local Planner (Controller)","Global Planner","Recovery Behavior","Costmap"],correctAnswer:1},{question:"What does the 'Inflation Layer' in a Costmap do?",options:["Makes the robot bigger","Adds a buffer zone around obstacles to prevent the robot from getting too close","Calculates air pressure","Draws the map in 3D"],correctAnswer:1},{question:"Urdu: Agar robot bar bar deewar mein takra raha hai, to aap Costmap ki kaunsi setting check karenge?",options:["Inflation Radius (barhayenge)","Resolution (kam karenge)","Robot ka rang","Map ka naam"],correctAnswer:0}]})]})}function j(e={}){const{wrapper:a}={...(0,r.R)(),...e.components};return a?(0,i.jsx)(a,{...e,children:(0,i.jsx)(g,{...e})}):g(e)}}}]);